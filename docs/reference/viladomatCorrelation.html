<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>viladomatCorrelation — viladomatCorrelation • STcompare</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="viladomatCorrelation — viladomatCorrelation"><meta name="description" content="Function to calculate Pearson's correlation between two spatial
  datasets, X and Y. To replace the analytical p-value which results in a
  high false positive rate for autocorrelated spatial patterns, it calculates
  empirical p-values from empirical null distributions generated from
  permuting dataset X by randomly shuffling the values and then smoothing to
  maintain the original degree of autocorrelation of X"><meta property="og:description" content="Function to calculate Pearson's correlation between two spatial
  datasets, X and Y. To replace the analytical p-value which results in a
  high false positive rate for autocorrelated spatial patterns, it calculates
  empirical p-values from empirical null distributions generated from
  permuting dataset X by randomly shuffling the values and then smoothing to
  maintain the original degree of autocorrelation of X"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">STcompare</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Install.html">Install</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/getting-started-with-STcompare.html">Getting Started with STcompare</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>viladomatCorrelation</h1>

      <div class="d-none name"><code>viladomatCorrelation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to calculate Pearson's correlation between two spatial
  datasets, X and Y. To replace the analytical p-value which results in a
  high false positive rate for autocorrelated spatial patterns, it calculates
  empirical p-values from empirical null distributions generated from
  permuting dataset X by randomly shuffling the values and then smoothing to
  maintain the original degree of autocorrelation of X</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">viladomatCorrelation</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">delta</span>,</span>
<span>  <span class="va">maxDistPrctile</span>,</span>
<span>  <span class="va">nPermutations</span>,</span>
<span>  nThreads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><code>matrix</code> A N x 4 matrix of with the first column as the
values of X, the second column as the values of Y, the third column as the
x-coordinates, and the fourth column as the y-coordinates.</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p><code>numeric vector</code> Given a point in dataset X, the percentage
of neighbors which should be within the smoothing kernel. This can be a
list or a single numeric. Input to `locfit::lp` as `nn`</p></dd>


<dt id="arg-maxdistprctile">maxDistPrctile<a class="anchor" aria-label="anchor" href="#arg-maxdistprctile"></a></dt>
<dd><p><code>numeric</code>: Percentile of distances between pixels
to use as max distance in when calculating variograms. At greater distances
the variogram is less precise because there are fewer pairs of points with
that distance between them. Therefore, since the goal is to minimize the
difference between the variogram of X and those of its permutations, the
variogram should be subsetted to the percentile that is more robust.</p></dd>


<dt id="arg-npermutations">nPermutations<a class="anchor" aria-label="anchor" href="#arg-npermutations"></a></dt>
<dd><p><code>integer</code>: Number of permutations to generate to
build the empirical null distribution. This number will determine the
precision of the p-value. For example, if <code>nPermutations &lt;- 100</code>, then
the smallest p-value is 0.01</p></dd>


<dt id="arg-nthreads">nThreads<a class="anchor" aria-label="anchor" href="#arg-nthreads"></a></dt>
<dd><p><code>integer</code>: Number of threads for parallelization.
Default = 1. Inputting this argument when the <code>BPPARAM</code> argument is
<code>NULL</code> would set parallel execution back-end to be
<code>BiocParallel::MulticoreParam(workers = nThreads)</code>. We recommend
setting this argument to be the number of cores available
(<code>parallel::detectCores(logical = FALSE)</code>). If <code>BPPARAM</code> argument
is not <code>NULL</code>, the <code>BPPARAM</code> argument would override
<code>nThreads</code> argument.</p></dd>


<dt id="arg-bpparam">BPPARAM<a class="anchor" aria-label="anchor" href="#arg-bpparam"></a></dt>
<dd><p><code>BiocParallelParam</code>: Optional additional argument for
parallelization. This argument is provided for advanced users of
<code>BiocParallel</code> for further flexibility for setting up
parallel-execution back-end. Default is NULL. If provided, this is assumed
to be an instance of <code>BiocParallelParam</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The output is returned as a list.</p><ul><li><p><code>deltaStarMedian</code>numeric, the median of the deltas that minimize
  the residual sum of squares across each permutation</p></li>
<li><p><code>deltaStar</code>numeric vector of length of `nPermutations`,
  the delta that minimizes the residual sum of squares for each permutation</p></li>
<li><p><code>pValueGlobal</code>numeric, empirical p-value for the Pearson's
  correlation of X and Y</p></li>
<li><p><code>nullCorGlobal</code>a B x 1 matrix, where B is `nPermutations`.
  This matrix is the correlation coefficients between the permutations and
  X that compose that null distribution used to calculate the empirical p-value</p></li>
<li><p><code>permutations</code>a N x B matrix, where B is `nPermutations`.
  Each column is the resulting values of a permutation of X</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>adapted from: Viladomat, Júlia et al. “Assessing the significance
of global and local correlations under spatial autocorrelation: a
nonparametric approach.” Biometrics vol. 70,2 (2014): 409-18.
doi:10.1111/biom.12139</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">quakes</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#remove duplicated positions</span></span></span>
<span class="r-in"><span><span class="va">quakes_data</span> <span class="op">&lt;-</span> <span class="va">quakes</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">quakes</span><span class="op">$</span><span class="va">lat</span>, <span class="va">quakes</span><span class="op">$</span><span class="va">long</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">quakes_data</span><span class="op">$</span><span class="va">depth</span>,</span></span>
<span class="r-in"><span>              <span class="va">quakes_data</span><span class="op">$</span><span class="va">mag</span>,</span></span>
<span class="r-in"><span>              <span class="va">quakes_data</span><span class="op">$</span><span class="va">lat</span>,</span></span>
<span class="r-in"><span>              <span class="va">quakes_data</span><span class="op">$</span><span class="va">long</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#sequence of deltas</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># maximum distance for the variogram set at the 25% percentile of</span></span></span>
<span class="r-in"><span><span class="co"># the distribution of pairs of distances:</span></span></span>
<span class="r-in"><span><span class="va">maxDistPrctile</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#number of permutations</span></span></span>
<span class="r-in"><span><span class="va">nPermutations</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">resultsPermuteX</span> <span class="op">&lt;-</span> <span class="fu">viladomatCorrelation</span><span class="op">(</span><span class="va">data</span>, <span class="va">delta</span>, <span class="va">maxDistPrctile</span>, <span class="va">nPermutations</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kalen Clifton, Vivien Jiang, Jean Fan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

