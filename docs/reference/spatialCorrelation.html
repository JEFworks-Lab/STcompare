<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>spatialCorrelation — spatialCorrelation • STcompare</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="spatialCorrelation — spatialCorrelation"><meta name="description" content="Function to calculate Pearson's correlation between two spatial
  datasets. To replace the analytical p-value which results in a high false
  positive rate for autocorrelated spatial patterns, it calculates empirical
  p-values from empirical null distributions generated from permuting the
  datasets and then smoothing to maintain the original degree of
  autocorrelation"><meta property="og:description" content="Function to calculate Pearson's correlation between two spatial
  datasets. To replace the analytical p-value which results in a high false
  positive rate for autocorrelated spatial patterns, it calculates empirical
  p-values from empirical null distributions generated from permuting the
  datasets and then smoothing to maintain the original degree of
  autocorrelation"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">STcompare</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Install.html">Install</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/getting-started-with-STcompare.html">Getting Started with STcompare</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>spatialCorrelation</h1>

      <div class="d-none name"><code>spatialCorrelation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to calculate Pearson's correlation between two spatial
  datasets. To replace the analytical p-value which results in a high false
  positive rate for autocorrelated spatial patterns, it calculates empirical
  p-values from empirical null distributions generated from permuting the
  datasets and then smoothing to maintain the original degree of
  autocorrelation</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spatialCorrelation</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  <span class="va">pos</span>,</span>
<span>  nPermutations <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  deltaX <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  deltaY <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxDistPrctile <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  returnPermutations <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nThreads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>numeric</code> or <code>matrix</code>: a 1 x N numeric vector or matrix
with N observations</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p><code>numeric</code> or <code>matrix</code>: a 1 x N numeric vector or matrix
with N observations</p></dd>


<dt id="arg-pos">pos<a class="anchor" aria-label="anchor" href="#arg-pos"></a></dt>
<dd><p><code>matrix</code>: a N x 2 matrix array of spatial x,y coordinates of
observations</p></dd>


<dt id="arg-npermutations">nPermutations<a class="anchor" aria-label="anchor" href="#arg-npermutations"></a></dt>
<dd><p><code>integer</code> or <code>double</code>: number of permutations
to generate to build the empirical null distribution. This number will
determine the precision of the p-value. Default is <code>100</code>, such that
the smallest p-value is 0.01</p></dd>


<dt id="arg-deltax">deltaX<a class="anchor" aria-label="anchor" href="#arg-deltax"></a></dt>
<dd><p><code>numeric</code>: A single numeric or a numeric vector for
controlling the degree of smoothing in permutations of X. Delta is a
proportion calculated by dividing k neighbors by N total observations in X,
where k is the number of neighbors in the permutation of X that should be
within the radius smoothed by the Gaussian kernel to achieve the amount of
autocorrelation present in the original X. If a single delta is not known,
a sequence of deltas can be inputted and the best delta will be found such
that it minimizes the sum of squares of the residuals between the variogram
of the permutation generated from the delta and the variogram of the
target. Default is <code>NULL</code>. If no value is supplied for <code>deltaX</code>,
<code>seq(0.1,0.9,0.1)</code>, the sequence of every 0.1 from 0.1 to 0.9, will be
used to find the best delta for X.</p></dd>


<dt id="arg-deltay">deltaY<a class="anchor" aria-label="anchor" href="#arg-deltay"></a></dt>
<dd><p><code>numeric</code>: A single numeric or numeric vector for
controlling the degree of smoothing in permutations of Y. <code>deltaY</code> is
like <code>deltaX</code> but for observation in Y instead of X. Default is
<code>NULL</code>. If no value is supplied for <code>deltaY</code>,
<code>seq(0.1,0.9,0.1)</code>, the sequence of every 0.1 from 0.1 to 0.9, will be
used to find the best delta for permutations of Y.</p></dd>


<dt id="arg-maxdistprctile">maxDistPrctile<a class="anchor" aria-label="anchor" href="#arg-maxdistprctile"></a></dt>
<dd><p><code>numeric</code>: percentile of distances between pixels
to use as max distance in when calculating variograms. Default = 0.25. At
greater distances the variogram is less precise because there are fewer
pairs of points with that distance between them. Therefore, since the goal
is to minimize the difference between the variogram of X and those of its
permutations, the variogram should be subsetted to the percentile that is
more robust.</p></dd>


<dt id="arg-returnpermutations">returnPermutations<a class="anchor" aria-label="anchor" href="#arg-returnpermutations"></a></dt>
<dd><p><code>logical</code>: <code>FALSE</code> (default) indicate
whether the outputted dataframe will have a column with the values of the
permutations used to calculate the null correlations and the empirical
p-value.</p></dd>


<dt id="arg-nthreads">nThreads<a class="anchor" aria-label="anchor" href="#arg-nthreads"></a></dt>
<dd><p><code>integer</code>: Number of threads for parallelization.
Default = 1. Inputting this argument when the <code>BPPARAM</code> argument is
<code>NULL</code> would set parallel execution back-end to be
<code>BiocParallel::MulticoreParam(workers = nThreads)</code>. We recommend
setting this argument to be the number of cores available
(<code>parallel::detectCores(logical = FALSE)</code>). If <code>BPPARAM</code> argument
is not <code>NULL</code>, the <code>BPPARAM</code> argument would override
<code>nThreads</code> argument.</p></dd>


<dt id="arg-bpparam">BPPARAM<a class="anchor" aria-label="anchor" href="#arg-bpparam"></a></dt>
<dd><p><code>BiocParallelParam</code>: Optional additional argument for
parallelization. This argument is provided for advanced users of
<code>BiocParallel</code> for further flexibility for setting up
parallel-execution back-end. Default is NULL. If provided, this is assumed
to be an instance of <code>BiocParallelParam</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The output is returned as a <code>data.frame</code> containing the columns:</p><ul><li><p><code>correlationCoef</code>Pearson's correlation coefficient.</p></li>
<li><p><code>pValueNaive</code>the analytical p-value naively assuming independent
  observations</p></li>
<li><p><code>pValuePermuteX</code>the p-value when creating an empirical null
  from permutations of observations in X</p></li>
<li><p><code>pValuePermuteY</code>the p-value when creating an empirical null from
  permutations of observations in Y</p></li>
<li><p><code>deltaStarMedianX</code>the median delta star (the delta which
  minimizes the difference between the variogram of the permutation and the
  variogram of observations) across permutations of X</p></li>
<li><p><code>deltaStarMedianY</code>the median delta star across permutations of Y</p></li>
<li><p><code>deltaStarX</code>list of delta star for all permutations of X</p></li>
<li><p><code>deltaStarY</code>list of delta star for all permutations of Y</p></li>
<li><p><code>nullCorrelationsX</code>correlation coefficients for pairing Y and
  all permutations of X</p></li>
<li><p><code>nullCorrelationsY</code>correlation coefficients for pairing X and
  all permutations of Y</p></li>
<li><p><code>permutationsX</code>(optional) a N x B matrix, where N is the
  length of X and B is `nPermutations`. Each column is the resulting values
  of a permutation of X</p></li>
<li><p><code>permutationsY</code>(optional) a N x B matrix, where N is the
  length of Y and B is `nPermutations`. Each column is the resulting values
  of a permutation of Y</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">quakes</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#remove duplicated positions</span></span></span>
<span class="r-in"><span><span class="va">quakes_data</span> <span class="op">&lt;-</span> <span class="va">quakes</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">quakes</span><span class="op">$</span><span class="va">lat</span>, <span class="va">quakes</span><span class="op">$</span><span class="va">long</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cor</span> <span class="op">&lt;-</span> <span class="fu">spatialCorrelation</span><span class="op">(</span>X <span class="op">=</span> <span class="va">quakes_data</span><span class="op">$</span><span class="va">depth</span>,</span></span>
<span class="r-in"><span>                          Y <span class="op">=</span> <span class="va">quakes_data</span><span class="op">$</span><span class="va">mag</span>,</span></span>
<span class="r-in"><span>                          pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">quakes_data</span><span class="op">$</span><span class="va">lat</span>, <span class="va">quakes_data</span><span class="op">$</span><span class="va">long</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cor</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     correlationCoef  pValueNaive pValuePermuteX pValuePermuteY deltaStarMedianX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor       -0.230266 1.779041e-13           0.05           0.09              0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     deltaStarMedianY   deltaStarX   deltaStarY nullCorrelationsX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor              0.5 0.5, 0.6.... 0.6, 0.7....      0.190177....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nullCorrelationsY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor      -0.08056....</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the delta star (the delta which minimizes the difference between the</span></span></span>
<span class="r-in"><span><span class="co"># variogram of the permutation and the variogram of observations) for all</span></span></span>
<span class="r-in"><span><span class="co"># permutations to see if clear peak found in the range inputted</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cor</span><span class="op">$</span><span class="va">deltaStarX</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spatialCorrelation-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cor</span><span class="op">$</span><span class="va">deltaStarY</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spatialCorrelation-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#plot null distribution of correlations to see if normally distributed</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cor</span><span class="op">$</span><span class="va">nullCorrelationsX</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spatialCorrelation-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cor</span><span class="op">$</span><span class="va">nullCorrelationsY</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spatialCorrelation-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#example of inputting specific range for deltaX and deltaY</span></span></span>
<span class="r-in"><span><span class="va">cor2</span> <span class="op">&lt;-</span> <span class="fu">spatialCorrelation</span><span class="op">(</span>X <span class="op">=</span> <span class="va">quakes_data</span><span class="op">$</span><span class="va">depth</span>,</span></span>
<span class="r-in"><span>                          Y <span class="op">=</span> <span class="va">quakes_data</span><span class="op">$</span><span class="va">mag</span>,</span></span>
<span class="r-in"><span>                          pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">quakes_data</span><span class="op">$</span><span class="va">lat</span>, <span class="va">quakes_data</span><span class="op">$</span><span class="va">long</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          deltaX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.9</span>, <span class="fl">0.05</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          deltaY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.5</span>, <span class="fl">0.02</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cor2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     correlationCoef  pValueNaive pValuePermuteX pValuePermuteY deltaStarMedianX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor       -0.230266 1.779041e-13           0.04           0.01             0.75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     deltaStarMedianY   deltaStarX   deltaStarY nullCorrelationsX</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor             0.24 0.9, 0.9.... 0.42, 0.....      -0.17102....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nullCorrelationsY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cor      0.060023....</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cor2</span><span class="op">$</span><span class="va">deltaStarX</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spatialCorrelation-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cor2</span><span class="op">$</span><span class="va">deltaStarY</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spatialCorrelation-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cor2</span><span class="op">$</span><span class="va">nullCorrelationsX</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spatialCorrelation-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cor2</span><span class="op">$</span><span class="va">nullCorrelationsY</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spatialCorrelation-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#visualizations of the spatial data to verify negative correlation</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">quakes_data</span>,</span></span>
<span class="r-in"><span>                      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, color <span class="op">=</span> <span class="va">depth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"lightblue"</span>, high <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Locations of Earthquakes off Fiji"</span>,</span></span>
<span class="r-in"><span>                x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>,</span></span>
<span class="r-in"><span>                color <span class="op">=</span> <span class="st">"Depth (km)"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html" class="external-link">coord_map</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">quakes_data</span>,</span></span>
<span class="r-in"><span>                      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, color <span class="op">=</span> <span class="va">mag</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"lightblue"</span>, high <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Locations of Earthquakes off Fiji"</span>,</span></span>
<span class="r-in"><span>                x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>,</span></span>
<span class="r-in"><span>                color <span class="op">=</span> <span class="st">"Richter Magnitude"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html" class="external-link">coord_map</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p1</span></span></span>
<span class="r-plt img"><img src="spatialCorrelation-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">p2</span></span></span>
<span class="r-plt img"><img src="spatialCorrelation-10.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kalen Clifton, Vivien Jiang, Jean Fan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

